# Скрипт для создания исполнителей и загрузки треков

Этот скрипт создает исполнителей через Gateway API и загружает их треки из папки `input/`.

## Требования

- Python 3.7+
- Установленные зависимости: `pip install -r requirements.txt`
- Запущенный Gateway сервис (по умолчанию на `http://localhost:8080`)

## Использование

### Базовое использование

```bash
python create_artists_and_tracks.py
```

### С параметрами

```bash
python create_artists_and_tracks.py \
  --gateway-url http://localhost:8080 \
  --email faker@example.com \
  --password faker123
```

### Параметры

- `--gateway-url` - URL Gateway API (по умолчанию: `http://localhost:8080`)
- `--email` - Email для регистрации/входа (по умолчанию: `faker@example.com`)
- `--password` - Пароль для регистрации/входа (по умолчанию: `faker123`)
- `--artists-file` - Путь к файлу с исполнителями (по умолчанию: `artists.json`)
- `--input-dir` - Директория с аудиофайлами (по умолчанию: `input`)

## Как это работает

1. Скрипт пытается войти в систему с указанными credentials
2. Если вход не удался, скрипт регистрирует нового пользователя
3. Для каждого исполнителя из `artists.json`:
   - Создает исполнителя через `POST /api/v1/artists`
   - Ищет соответствующий аудиофайл в папке `input/`
   - Загружает трек через `POST /api/v1/upload/track`
4. Выводит итоговую статистику

## Сопоставление файлов с исполнителями

Скрипт автоматически сопоставляет файлы из папки `input/` с исполнителями из `artists.json` по имени. 

**Структура папок:**
Файлы организованы в подпапках по имени исполнителя:
```
input/
  ANNA_ASTI/
    По барам.wav
  KOROL_I_SHUT/
    Кукла колдуна.wav
    Лесник.wav
  ...
```

Скрипт ищет папку с именем, соответствующим исполнителю, и берет первый найденный `.wav` файл из этой папки.

Если у исполнителя несколько файлов в папке, будет использован первый найденный.

## Структура файлов

```
scripts/faker/
├── artists.json                    # Список исполнителей
├── input/                          # Папка с аудиофайлами
│   ├── ANNA_ASTI/
│   │   └── По барам.wav
│   ├── APENT/
│   │   └── Невозможное возможно.wav
│   ├── KOROL_I_SHUT/
│   │   ├── Кукла колдуна.wav
│   │   └── Лесник.wav
│   └── ...
├── create_artists_and_tracks.py   # Основной скрипт
├── requirements.txt                # Зависимости Python
└── README.md                       # Этот файл
```

## Пример вывода

```
Попытка входа/регистрации с email: faker@example.com
✓ Успешная регистрация

[1/9] Обработка исполнителя: Anna Asti
  ✓ Исполнитель создан: abc123-def456-...
  ✓ Найден файл: ANNA_ASTI_-_Po_baram_74376135.wav
  ✓ Трек загружен: Po baram (ID: xyz789-...)

...

============================================================
ИТОГИ:
  Создано исполнителей: 9
  Загружено треков: 9
============================================================
```

## Обработка ошибок

Скрипт продолжает работу даже если:
- Не удалось создать исполнителя (выводит ошибку и продолжает)
- Не найден файл для исполнителя (пропускает загрузку)
- Не удалось загрузить трек (выводит ошибку и продолжает)

В конце выводится итоговая статистика успешно выполненных операций.

